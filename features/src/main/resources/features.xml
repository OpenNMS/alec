<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<features name="oce-features" xmlns="http://karaf.apache.org/xmlns/features/v1.4.0">

    <repository>mvn:org.kie/kie-karaf-features/${drools.version}/xml/features</repository>

    <feature name="oce" description="OpenNMS Correlation Engine" version="${project.version}">
        <feature version="${project.version}">oce-connector</feature>
        <feature version="${project.version}">oce-drools-engine</feature>
        <feature version="${project.version}">oce-model</feature>
    </feature>

    <feature name="oce-model" description="OCE :: Model" version="${project.version}">
        <bundle>mvn:org.opennms.oce.model/org.opennms.oce.model.api/${project.version}</bundle>
        <bundle>mvn:org.opennms.oce.model/org.opennms.oce.model.jaxb/${project.version}</bundle>
        <bundle>mvn:org.opennms.oce.model/org.opennms.oce.model.impl/${project.version}</bundle>
        <bundle>mvn:org.opennms.oce.model/org.opennms.oce.model.shell/${project.version}</bundle>
        <bundle dependency="true">mvn:com.google.guava/guava/19.0</bundle>
        <bundle dependency="true">mvn:org.apache.commons/commons-text/1.3</bundle>
        <bundle dependency="true">mvn:org.apache.commons/commons-lang3/3.7</bundle>
        <bundle dependency="true">wrap:mvn:org.jvnet.jaxb2_commons/jaxb2-basics-tools/0.11.1</bundle>
        <bundle dependency="true">wrap:mvn:org.jvnet.jaxb2_commons/jaxb2-basics-runtime/0.11.1</bundle>
        <bundle dependency="true">mvn:javax.xml.bind/jaxb-api/2.3.0</bundle>
        <bundle dependency="true">mvn:com.sun.xml.bind/jaxb-core/2.3.0</bundle>

        <bundle>mvn:org.apache.commons/commons-csv/${commons.csv.version}</bundle>
        <bundle>wrap:mvn:com.google.code.gson/gson/${gson.version}</bundle>

    </feature>

    <feature name="oce-connector" description="OCE :: Connector" version="${project.version}">
        <feature version="1.0.0">kafka-streams</feature>
        <bundle>mvn:org.opennms.oce.connector/org.opennms.oce.connector.api/${project.version}</bundle>
        <bundle>mvn:org.opennms.oce.connector/org.opennms.oce.connector.impl/${project.version}</bundle>
        <bundle>mvn:com.google.protobuf/protobuf-java/${protobuf.version}</bundle>
        <bundle>mvn:org.opennms.oce.connector/org.opennms.oce.connector.shell/${project.version}</bundle>

        <bundle dependency='true'>mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.okio/${okio.bundle.version}</bundle>
        <bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.okhttp/${okhttp.bundle.version}</bundle>
        <bundle>wrap:mvn:com.squareup.okhttp3/logging-interceptor/${okhttp.version}</bundle>
        <bundle>wrap:mvn:com.google.code.gson/gson/${gson.version}</bundle>
    </feature>

    <feature name="oce-drools-engine" description="OCE :: Drools Engine" version="${project.version}">
        <bundle dependency="true">mvn:org.opennms.oce.connector/org.opennms.oce.connector.api/${project.version}</bundle>
        <feature version="${drools.version}">kie</feature>
        <feature version="${drools.version}">drools-module</feature>
        <bundle>mvn:org.opennms.oce.drools/org.opennms.oce.drools.engine/${project.version}</bundle>
    </feature>

    <feature name="kafka-streams" description="Kafka Streams" version="1.0.0">
        <bundle dependency="true">wrap:mvn:org.apache.kafka/kafka-streams/1.0.0$Bundle-Version=1.0.0&amp;Export-Package=*;-noimport:=true:version="1.0.0"</bundle>
        <bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.kafka-clients/1.0.0_2</bundle>
        <bundle dependency="true">mvn:org.lz4/lz4-java/1.4</bundle>
        <bundle dependency="true">mvn:org.xerial.snappy/snappy-java/1.1.4</bundle>
        <bundle dependency="true">wrap:mvn:org.apache.kafka/connect-json/1.0.0</bundle>
        <bundle dependency="true">wrap:mvn:org.apache.kafka/connect-api/1.0.0</bundle>
        <bundle dependency="true">mvn:com.fasterxml.jackson.core/jackson-databind/2.6.6</bundle>
        <bundle dependency="true">mvn:com.fasterxml.jackson.core/jackson-annotations/2.6.6</bundle>
        <bundle dependency="true">mvn:com.fasterxml.jackson.core/jackson-core/2.6.6</bundle>
        <bundle dependency="true">wrap:mvn:org.rocksdb/rocksdbjni/5.7.3</bundle>
    </feature>

</features>
