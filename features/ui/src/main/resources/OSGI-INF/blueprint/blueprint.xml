<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0">

    <!-- Expose our UI Extension -->
    <service id="uiExtension" interface="org.opennms.integration.api.v1.ui.UIExtension">
        <bean class="org.opennms.alec.ui.UIExtension">
            <property name="id" value="uiExtension"/>
            <property name="menuEntry" value="ALEC"/>
            <property name="resourceRoot" value="ui-ext"/>
            <property name="moduleFileName" value="uiextension.es.js"/>
        </bean>
    </service>

    <!-- Build and expose the JAX-RS annotated webhook handler.
     This will automatically mount the endpoint over the REST API. -->
    <bean id="engineRest" class="org.opennms.alec.rest.EngineRestImpl">
        <argument ref="keyValueStore"/>
        <argument ref="driver"/>
        <argument ref="engineFactories"/>
    </bean>

    <bean id="agreementRest" class="org.opennms.alec.rest.AgreementRestImpl">
        <argument ref="keyValueStore"/>
    </bean>

    <bean id="situationRest" class="org.opennms.alec.rest.SituationRestImpl">
        <argument ref="keyValueStore"/>
        <argument ref="situationDatasource"/>
        <argument ref="alarmDatasource"/>
    </bean>

    <service interface="org.opennms.alec.rest.AgreementRest" ref="agreementRest">
        <service-properties>
            <entry key="application-path" value="/rest" />
        </service-properties>
    </service>

    <service interface="org.opennms.alec.rest.EngineRest" ref="engineRest">
        <service-properties>
            <entry key="application-path" value="/rest" />
        </service-properties>
    </service>

    <service interface="org.opennms.alec.rest.SituationRest" ref="situationRest">
        <service-properties>
            <entry key="application-path" value="/rest" />
        </service-properties>
    </service>

    <!--Key-value store -->
    <reference id="keyValueStore" interface="org.opennms.integration.api.v1.distributed.KeyValueStore" availability="optional"/>

    <reference id="driver" interface="org.opennms.alec.engine.api.EngineRegistry"/>

    <!--engines list    -->
    <reference-list id="engineFactories" interface="org.opennms.alec.engine.api.EngineFactory"/>

    <!--situation datasource    -->
    <reference id="situationDatasource" interface="org.opennms.alec.datasource.api.SituationDatasource" />

    <!--alarm datasource    -->
    <reference id="alarmDatasource" interface="org.opennms.alec.datasource.api.AlarmDatasource" />

</blueprint>